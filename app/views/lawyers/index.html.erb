<% content_for(:title, "Browse Lawyers - JusticeHub") %>

<div class="page-header">
  <h1>Find a Lawyer</h1>
  <p>Browse our verified lawyers across different specializations</p>
</div>

<div class="lawyers-container">
  <aside class="filters-sidebar">
    <h3>Filters</h3>
    <%= form_tag lawyers_path, method: :get, class: "filter-form" do %>
      <div class="filter-group">
        <%= label_tag :specialization, "Specialization" %>
        <%= select_tag :specialization, 
            options_for_select([["All Specializations", ""]] + @specializations.map { |s| [s.titleize, s] }, params[:specialization]),
            class: "form-control" %>
      </div>

      <div class="filter-group">
        <%= label_tag :location, "Location" %>
        <%= select_tag :location, 
            options_for_select([["All Locations", ""]] + @locations, params[:location]),
            class: "form-control" %>
      </div>

      <div class="filter-group">
        <%= label_tag :min_experience, "Min Experience (years)" %>
        <%= select_tag :min_experience, 
            options_for_select([["Any", ""]] + (1..30).to_a, params[:min_experience]),
            class: "form-control" %>
      </div>

      <div class="filter-group">
        <%= label_tag :max_fee, "Max Consultation Fee (₹)" %>
        <%= select_tag :max_fee, 
            options_for_select([["Any", ""], ["500", 500], ["1000", 1000], ["2000", 2000], ["3000", 3000], ["5000", 5000], ["10000", 10000]], params[:max_fee]),
            class: "form-control" %>
      </div>

      <div class="filter-group">
        <%= label_tag :sort, "Sort By" %>
        <%= select_tag :sort, 
            options_for_select([["Newest", "newest"], ["Highest Rated", "rating"], ["Most Experienced", "experience"]], params[:sort] || "newest"),
            class: "form-control" %>
      </div>

      <%= submit_tag "Apply Filters", class: "btn btn-primary" %>
      <%= link_to "Clear Filters", lawyers_path, class: "btn btn-secondary" %>
    <% end %>
  </aside>

  <main class="lawyers-list">
      <div class="results-header">
        <span><%= @lawyers.count %> lawyers found</span>
      </div>

      <% if @lawyers.any? %>
        <div class="lawyers-grid">
          <% @lawyers.each do |lawyer| %>
            <div class="lawyer-card">
              <div class="lawyer-header">
                <%= image_tag lawyer.avatar_url, alt: lawyer.name, class: "lawyer-avatar" %>
                <div class="lawyer-info">
                  <h3><%= lawyer.name %></h3>
                  <p class="specialization"><%= lawyer.full_specialization %></p>
                  <div class="rating">
                    <span class="stars"><%= "★" * lawyer.rating.round %><%= "☆" * (5 - lawyer.rating.round) %></span>
                    <span class="rating-value"><%= lawyer.formatted_rating %></span>
                  </div>
                </div>
              </div>

              <div class="lawyer-details">
                <div class="detail-item">
                  <i class="fas fa-briefcase"></i>
                  <span><%= lawyer.formatted_experience %> experience</span>
                </div>
                <div class="detail-item">
                  <i class="fas fa-map-marker-alt"></i>
                  <span><%= lawyer.location || "Not specified" %></span>
                </div>
                <div class="detail-item">
                  <i class="fas fa-language"></i>
                  <span><%= lawyer.languages_list.join(", ") %></span>
                </div>
                <div class="detail-item fee">
                  <i class="fas fa-rupee-sign"></i>
                  <span><%= lawyer.consultation_fee_display %></span>
                </div>
              </div>

              <p class="lawyer-bio"><%= truncate(lawyer.bio, length: 100) if lawyer.bio %></p>

              <div class="lawyer-actions">
                <%= link_to "View Profile", lawyer_path(lawyer), class: "btn btn-primary" %>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="no-results">
          <i class="fas fa-search"></i>
          <h3>No lawyers found</h3>
          <p>Try adjusting your filters to see more results</p>
          <%= link_to "Clear Filters", lawyers_path, class: "btn btn-primary" %>
        </div>
      <% end %>
    </main>
  </div>

<style>
.page-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 60px 24px;
  text-align: center;
}

.page-header h1 {
  font-size: 36px;
  margin-bottom: 12px;
}

.page-header p {
  font-size: 18px;
  opacity: 0.9;
}

.lawyers-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 40px 24px;
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 40px;
}

.filters-sidebar {
  background: white;
  padding: 24px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  height: fit-content;
  position: sticky;
  top: 100px;
}

.filters-sidebar h3 {
  margin-bottom: 20px;
  font-size: 18px;
}

.filter-group {
  margin-bottom: 16px;
}

.filter-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  color: #4a5568;
}

.filter-group .form-control {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-size: 14px;
}

.filter-form .btn {
  width: 100%;
  margin-bottom: 8px;
}

.results-header {
  margin-bottom: 20px;
  color: #718096;
}

.lawyers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 24px;
}

.lawyer-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  padding: 24px;
  transition: transform 0.2s, box-shadow 0.2s;
}

.lawyer-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
}

.lawyer-header {
  display: flex;
  gap: 16px;
  margin-bottom: 16px;
}

.lawyer-avatar {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  object-fit: cover;
}

.lawyer-info h3 {
  font-size: 18px;
  margin-bottom: 4px;
}

.lawyer-info .specialization {
  color: #667eea;
  font-weight: 500;
  margin-bottom: 8px;
}

.rating {
  display: flex;
  align-items: center;
  gap: 8px;
}

.stars {
  color: #f6ad55;
}

.rating-value {
  color: #718096;
  font-size: 14px;
}

.lawyer-details {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 16px;
}

.detail-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: #718096;
}

.detail-item i {
  width: 16px;
  color: #667eea;
}

.detail-item.fee {
  grid-column: span 2;
  font-weight: 600;
  color: #2d3748;
  font-size: 16px;
}

.lawyer-bio {
  color: #718096;
  font-size: 14px;
  margin-bottom: 16px;
  line-height: 1.5;
}

.lawyer-actions .btn {
  width: 100%;
}

.no-results {
  text-align: center;
  padding: 60px 24px;
  color: #718096;
}

.no-results i {
  font-size: 48px;
  margin-bottom: 16px;
  color: #cbd5e0;
}

@media (max-width: 900px) {
  .lawyers-container {
    grid-template-columns: 1fr;
  }

  .filters-sidebar {
    position: static;
  }
}
</style>
